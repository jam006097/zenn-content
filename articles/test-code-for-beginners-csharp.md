---
title: "[ちょっと幸せになる]テストコードの第一歩_C#編"
emoji: "😊"
type: "tech"
topics: ["csharp", "xunit", "testing", "beginner"]
published: false
---

## はじめに

「1ヶ月前に自分が書いたコードなのに、どうしてこう書いたのか思い出せない...」
「この部分を修正したいけど、どこまで影響があるのかわからなくて怖い...」

開発者なら誰でも一度は経験する、そんな悩みを抱えていませんか？🤔

この記事では、そんなあなたを助けてくれる「テストコード」の第一歩を、C#とxUnitを使ってご紹介します。

「テストコードって品質管理のためでしょ？なんだか難しそう...」と感じるかもしれません。もちろん、品質はとても大切です。でも、テストコードがもたらす一番の恩恵は、**未来のあなた自身を助けてくれる**ことにあるのです。この記事を読み終える頃には、きっとその意味がわかるはずです。

## テストコードは「未来の自分への申し送り」

なぜテストコードが未来の自分を助けてくれるのでしょうか？

- **動く仕様書になる**: テストコードは「このコードは、こういう入力に対して、こう動くべきだ」という仕様を、実行可能な形で記録したものです。数ヶ月後にコードを見返したとき、テストコードを読めば、そのコードが何をするためのものだったのかをすぐに思い出せます。
- **安心して修正できるお守りになる**: 機能追加やリファクタリングでコードを修正したとき、テストを実行すれば、既存の機能が壊れていない（デグレしていない）ことを一瞬で確認できます。この安心感は、コードを積極的に改善していく上で、強力な武器になります。

つまりテストコードは、**1ヶ月後の自分が仕様を忘れても大丈夫なように残しておく「動く仕様書」であり、「未来の自分への申し送り事項」** なのです。

## C# と xUnit で最初のテストを書いてみよう

それでは、実際に簡単なテストコードを書いてみましょう。ここでは、C#の公式テストフレームワークの一つである「xUnit」を使います。

### 1. テスト対象のコードを準備する

まずは、テスト対象となる簡単な計算クラス `Calculator` を持つプロジェクトを作成します。

```csharp
// Calculator.cs
namespace MyFirstTest
{
    public class Calculator
    {
        public int Add(int a, int b)
        {
            return a + b;
        }
    }
}
```

この `Add` メソッドが正しく足し算をしてくれるか、テストを書いていきましょう。

### 2. テストコードを書く

次に、この `Calculator` クラスをテストするためのコードを書きます。xUnitでは、`[Fact]` という属性を付けたメソッドがテストとして実行されます。

**（ここに画像を貼る想定）**
以下にサンプルコードを記載します。

```csharp
// CalculatorTests.cs
using Xunit;

namespace MyFirstTest.Tests
{
    public class CalculatorTests
    {
        [Fact]
        public void Add_TwoNumbers_ReturnsCorrectSum()
        {
            // Arrange: 準備
            var calculator = new Calculator();
            int a = 5;
            int b = 3;
            int expected = 8;

            // Act: 実行
            int actual = calculator.Add(a, b);

            // Assert: 検証
            Assert.Equal(expected, actual);
        }
    }
}
```

テストコードは、一般的に**AAAパターン**（Arrange-Act-Assert）と呼ばれる3つのステップで構成されます。

1.  **Arrange (準備)**: テストに必要なオブジェクトやデータを準備します。ここでは `Calculator` のインスタンスを作成し、計算に使う変数を用意しています。
2.  **Act (実行)**: テスト対象のメソッドを実行します。ここでは `Add` メソッドを呼び出し、結果を変数 `actual` に格納しています。
3.  **Assert (検証)**: 実行結果が期待通りであるかを確認します。ここでは `Assert.Equal` を使って、期待値 `expected` と実際の値 `actual` が等しいことを検証しています。

このテストは、「`Calculator`の`Add`メソッドは、5と3を引数に渡すと、8を返すはずだ」という仕様をコードで表現しているのです。

### 3. テストを実行する

ターミナルで `dotnet test` コマンドを実行してみましょう。テストが成功すれば、以下のようなメッセージが表示されます。

```
Test run for /path/to/MyFirstTest/bin/Debug/netX.X/MyFirstTest.Tests.dll (.NETCoreApp,Version=vX.X)
Passed!  - Failed:     0, Passed:     1, Skipped:     0, Total:     1, Duration: < 1 sec
```

「Passed: 1」と表示されていれば成功です！🎉 これで、あなたの `Add` メソッドが期待通りに動作することが証明されました。

## まとめ

お疲れ様でした！これがテストコードの第一歩です。

最初は難しく感じるかもしれませんが、完璧なテストを目指す必要はありません。まずは簡単なメソッド一つからでも大丈夫です。

今日あなたが書いた1行のテストコードが、1ヶ月後、あるいは1年後のあなたをきっと助けてくれます。「あの時の自分、ありがとう！」と思えるように、未来の自分がちょっと幸せになるためのタイムカプセルを、今日のコードに埋め込んでみませんか？
